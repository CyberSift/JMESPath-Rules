[
  {
    "title": "O365 Suspicious Inbox Rule Created or Modified (MarkAsRead)",
    "expression": "contains(['New-InboxRule', 'Set-InboxRule'], o365.audit.Operation) && to_string(o365.audit.Parameters.MarkAsRead)=='True'",
    "severity": "high",
    "type": "o365"
  },
  {
    "title": "O365 Suspicious Inbox Rule Created or Modified (Suspicious Folder)",
    "expression": "contains(['New-InboxRule', 'Set-InboxRule'], o365.audit.Operation) && (contains(to_string(o365.audit.Parameters.MoveToFolder), 'RSS') || contains(to_string(o365.audit.Parameters.MoveToFolder), 'Archive'))",
    "severity": "high",
    "type": "o365"
  },
  {
    "title": "O365 Mailbox Audit Logging Bypass",
    "expression": "event.dataset == 'o365.audit' && event.provider == 'Exchange' && event.action == 'Set-MailboxAuditBypassAssociation' && event.outcome == 'success'",
    "severity": "high",
    "type": "o365"
  },
  {
    "title": "O365 Exchange Transport Rule Creation",
    "expression": "event.dataset == 'o365.audit' && event.provider == 'Exchange' && event.category == 'web' && event.action == 'New-TransportRule' && event.outcome == 'success'",
    "severity": "high",
    "type": "o365"
  },
  {
    "title": "O365 User Login with Suspicious User Agent",
    "expression": "o365.audit.Operation == 'UserLoggedIn' && o365.audit.ExtendedProperties.UserAgent != null && (!starts_with(to_string(o365.audit.ExtendedProperties.UserAgent), 'Mozilla') && !starts_with(to_string(o365.audit.ExtendedProperties.UserAgent), 'Windows-AzureAD-Authentication-Provider') && !starts_with(to_string(o365.audit.ExtendedProperties.UserAgent), 'BAV2ROPC') && !starts_with(to_string(o365.audit.ExtendedProperties.UserAgent), 'AppSSOAgent'))",
    "severity": "high",
    "type": "o365"
  }
]
