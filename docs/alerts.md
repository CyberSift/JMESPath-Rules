# JMESPath Rules Alerts Documentation

This document describes all alert types generated by the JMESPath rules engine, including their triggers, fields, and descriptions. Alerts are generated when specific JMESPath-based detection rules, context enrichments, or anomaly conditions are met during syslog or event processing. Each alert is structured as a JSON object with the following fields:

## Alert Structure

- `@timestamp`: The time the alert was generated (UTC, ISO8601 format).
- `tags`: List of tags categorizing the alert (e.g., `jmespath`, `custom`, `anomaly`).
- `title`: Short title describing the alert.
- `description`: Detailed description of the alert.
- `severity`: Severity level (e.g., `high`, `medium`, `low`, `info`).
- `host`: Host or system associated with the alert.
- `details`: Additional details relevant to the alert.
- `samples`: Sample or user/host involved.
- `original`: (Optional) The original event or parsed JSON that triggered the alert.

---

## JMESPath Rule-Based Alerts

JMESPath rules allow for flexible, dynamic detection logic. Each rule defines its own matching criteria, severity, tags, and descriptive fields. The following sections describe the general structure and examples of alerts generated by JMESPath rules.

## Alerts by Rule

### Syslog Alerts

#### High Severity
- **SSH to or from known threat public IP**
  - **Severity:** High
  - **Description:** Triggered when an SSH connection (port 22) is made to or from a public IP identified as a known threat, and the flow is not denied.
- **RDP to or from known threat public IP**
  - **Severity:** High
  - **Description:** Triggered when an RDP connection (port 3389) is made to or from a public IP identified as a known threat, and the flow is not denied.
- **SMB to or from known threat public IP**
  - **Severity:** High
  - **Description:** Triggered when an SMB connection (port 445) is made to or from a public IP identified as a known threat, and the flow is not denied.

#### Medium Severity
- **Potential Data Leak - Dropbox Usage**
  - **Severity:** Medium
  - **Description:** Triggered when network traffic is detected to Dropbox ASN, indicating potential data exfiltration.
- **SMB to public IP**
  - **Severity:** Medium
  - **Description:** Triggered when an internal source initiates an SMB connection (port 445) to a public IP and the flow is not denied.
- **Connection From Known Threat (Source IP Known Threat)**
  - **Severity:** Medium
  - **Description:** Triggered when an inbound connection is detected from a known threat source IP and the flow is not denied.
- **Connection To Known Threat (Destination IP Known Threat)**
  - **Severity:** Medium
  - **Description:** Triggered when an outbound connection is detected to a known threat destination IP and the flow is not denied.

#### Low Severity
- **SSH to public IP**
  - **Severity:** Low
  - **Description:** Triggered when an internal source initiates an SSH connection (port 22) to a public IP and the flow is not denied.
- **RDP from public IP**
  - **Severity:** Low
  - **Description:** Triggered when an RDP connection (port 3389) is initiated from a public IP and the flow is not denied.
- **SMB from public IP**
  - **Severity:** Low
  - **Description:** Triggered when an SMB connection (port 445) is initiated from a public IP and the flow is not denied.

---

### Windows Alerts

#### High Severity
- **Non-existent wordlist user login**
  - **Severity:** High
  - **Description:** Triggered when a login attempt is made with a username from a sensitive wordlist (e.g., ftpuser, backup, operator, superuser) and the user does not exist.
- **Well known credential dumping tool use**
  - **Severity:** High
  - **Description:** Triggered when a service is installed with a filename matching known credential dumping tools (e.g., mimikatz, pwdump, gsecdump).
- **NULL SID Login**
  - **Severity:** High
  - **Description:** Triggered when a login is detected with a NULL SID, indicating a potentially abnormal login.
- **Abnormal Login Source Workstation by High Privilege User**
  - **Severity:** High
  - **Description:** Triggered when a high privilege user logs in from an abnormal source workstation.
- **Administrator Login - direct administrator logins should be disabled.**
  - **Severity:** High
  - **Description:** Triggered when a direct login as 'administrator' is detected, which is a security risk.

#### Medium Severity
- **Local Administrator Activity**
  - **Severity:** Medium
  - **Description:** Triggered when the 'Administrator' account is used for activity other than specific event codes (4798, 4780).
- **Non-existent user login**
  - **Severity:** Medium
  - **Description:** Triggered when a login attempt is made with a non-existent username of type 'user'.
- **Abnormal Login Source Workstation First Time Seen**
  - **Severity:** Medium
  - **Description:** Triggered when a login is detected from a workstation not previously seen for the user.
- **Abnormal Login Source Workstation Rarely Seen**
  - **Severity:** Medium
  - **Description:** Triggered when a login is detected from a workstation rarely used by the user.
- **High Privilege User Login**
  - **Severity:** Medium
  - **Description:** Triggered when a high privilege user logs in.
- **Possible Lateral Movement**
  - **Severity:** Medium
  - **Description:** Triggered when activity suggests possible lateral movement within the network.
- **Possible NTLM Relay**
  - **Severity:** Medium
  - **Description:** Triggered when activity suggests a possible NTLM relay attack.
- **Abnormal Login Source Workstation**
  - **Severity:** Medium
  - **Description:** Triggered when a normal privilege user logs in from an abnormal workstation.
- **Disabled User Activity**
  - **Severity:** Medium
  - **Description:** Triggered when activity is detected for a disabled user account.